<!-- Copyright 2017 Apinf Oy
This file is covered by the EUPL license.
You may obtain a copy of the licence at
https://joinup.ec.europa.eu/community/eupl/og_page/european-union-public-licence-eupl-v11 -->

<template name="settings">
  {{> settingsMenu }}
  <div class="container">
    {{# autoForm
      collection=settingsCollection
      doc=editDoc
      id="settings"
      type=formType }}
    <div class="block-wrapper settings-fields">
      <h2>{{_ "settingsPage_title" }}</h2>
      {{> afQuickField name='access.onlyAdminsCanAddApis' id="addapi-adminonly" }}
      {{> afQuickField name='access.onlyAdminsCanAddOrganizations' id="addorganization-adminonly" }}
      {{> afQuickField name='developmentFeatures' id="development-features" }}
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="panel-title">
            {{_ "settings_title_supportsGraphql" }}
          </span>
          <span class="pull-right">
            {{> afQuickField name='supportsGraphql' id="supports-graphql" }}
          </span>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="panel-title">
            {{_ "settings_sdkCode_generator" }}
          </span>
          <span class="pull-right">
            {{> afQuickField name='sdkCodeGenerator.enabled' id="SDK-code-generator" }}
          </span>
        </div>
        {{# if afFieldValueIs name="sdkCodeGenerator.enabled" value=true }}
        <div class="panel panel-default">
          <div class="panel-body">
            {{> afQuickField name='sdkCodeGenerator.host' id="SDK-host" }}
          </div>
        </div>
        {{/ if }}
      </div>

      <!-- Show or hide mail settings -->
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="panel-title">
            {{_ "settings_mail" }}
          </span>
          <span class="pull-right">
            {{> afQuickField name='mail.enabled' id="email" }}
          </span>
        </div>
        {{# if afFieldValueIs name='mail.enabled' value=true }}
          <div class="panel-body">
            {{> afQuickField name='mail.username' id="email-username" }}
            {{> afQuickField name='mail.password' type="password" id="email-password" }}
            {{> afQuickField name='mail.smtpHost' id="email-host" }}
            {{> afQuickField name='mail.smtpPort' id="email-port" }}
            <a  tabindex="0"
                role="button"
                data-toggle="popover"
                data-placement="left"
                data-trigger="focus"
                data-content="{{_ 'settings_mail_fromEmail' }}">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
            {{> afQuickField name='mail.fromEmail' id="email-send" }}
            <a  tabindex="0"
                role="button"
                data-toggle="popover"
                data-placement="left"
                data-trigger="focus"
                data-content="{{_ 'settings_mail_toEmail' }}">
              <i class="fa fa-question-circle" aria-hidden="true"></i>
            </a>
            {{> afQuickField name='mail.toEmail' id="email-recieve" }}
          </div>
        {{/ if }}
      </div>

      <!-- Show or hide EMQ dashboard data source settings -->
      {{# if userCanViewMqttDashboard }}
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="panel-title">
            {{_ "settings_es_request" }}
          </span>
          <span class="pull-right">
            {{> afQuickField name='esDashboardData.enabled' id="esDashboardData" }}
          </span>
        </div>
        {{# if afFieldValueIs name='esDashboardData.enabled' value=true }}
          <div class="panel-body">
            {{> afQuickField name='esDashboardData.request' id="esDashboardData-request" }}
          </div>
        {{/ if }}
      </div>
      {{/ if }}

      <!-- Possibility to hide login methods -->
      <div class="panel panel-default" style="border-color: red; border-width: 2px;">
        <div class="panel-heading">
          <span class="panel-title">
            {{_ "settings_disabled_login_methods" }}
          </span>
        </div>
        <div class="panel-body">
          <div class="row">
            <div class="col-sm-4">
              {{> afQuickField name='loginMethods.fiware' id="fiware-login" }}
              {{> afQuickField name='loginMethods.github' id="github-login" }}
              {{> afQuickField name='loginMethods.hsl_id' id="hsl-login" }}
              {{> afQuickField name='loginMethods.username_psw' id="username-psw-login" }}
            </div>

            <div class="col-sm-8">
                <span style="color: red;">{{_ "settings_disabled_login_methods_caution" }}</span>
                {{_ "settings_disabled_login_methods_caution_text" }}
                <ul>
                  <li>
                    {{_ "settings_disabled_login_methods_caution_warning_1"}}
                  </li>
                  <li>
                    {{_ "settings_disabled_login_methods_caution_warning_2" }}
                  </li>
                </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- Save settings -->
      <button
        type="submit"
        class="btn btn-success btn-success-special"
        id="save-settings">
        {{_ "settings_save" }}
      </button>
    </div>
    {{/ autoForm }}
  </div>
</template>

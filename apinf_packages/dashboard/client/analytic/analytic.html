<!-- Copyright 2017 Apinf Oy
This file is covered by the EUPL license.
You may obtain a copy of the licence at
https://joinup.ec.europa.eu/community/eupl/og_page/european-union-public-licence-eupl-v11 -->

<template name="apiAnalyticPage">
  <div class="api-view">
    <div class="container">
      {{# if Template.subscriptionsReady }}
        <h1>
          {{ api.name }}
        </h1>

        <!-- Toolbar -->
        <div class="row">
          <div class="col-md-12">
            <div class="form-inline form-group pull-left">
              {{# with api }}
                <!-- Bookmark -->
                <div class="api-card-bookmark form-group">
                  <i class="fa fa-bookmark bookmark-default"></i>
                  {{ bookmarkCount }}
                </div>
                <!-- Rating -->
                <div class="api-card-star-average form-group"
                     data-toggle="tooltip"
                     data-placement="bottom"
                     data-original-title="{{_ 'apiCard_tooltipTitle_averageRating' }}">
                  <i class="fa fa-star-half-o"></i>
                  {{ getAverageRating }}
                </div>
              {{/ with }}
              <div class="form-group">
                <strong>
                  {{_ 'apiAnalyticPage_labelText_proxyName' name=proxyName }}
                </strong>
              </div>
            </div>
            <div class="toolbar pull-right">
              <select class="form-control toolbar-select" id="date-range">
                <option value="yesterday">
                  {{_ 'apiAnalyticPage_optionText_yesterday' }}
                </option>
                <option value="week" selected>
                  {{_ 'apiAnalyticPage_optionText_7days' }}
                </option>
                <option value="month">
                  {{_ 'apiAnalyticPage_optionText_30days' }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <!-- Data is not ready -->
        {{# unless fetchingData }}
          {{> spinner }}
        {{ else }}
          <!-- If error returns -->
          {{# if error }}
            <h1>
              {{_ 'apiAnalyticPage_text_elasticsearchError' }}
            </h1>
            <p>{{ error }}</p>
          {{/ if }}

          <!-- Request path has metrics data -->
          {{# if dataInNotEmpty }}
            {{> apiAnalyticView elasticsearchData=elasticsearchData id=proxyBackendId }}
          {{ else }}
            <p class="alert alert-warning text-center overview-col-title">
              {{_ 'apiAnalyticPage_warningText_noData' }}
            </p>
          {{/ if }}
        {{/ unless }} <!-- /fetchingData -->
      {{ else }}
        {{> spinner }}
      {{/ if }} <!-- /subscriptionReady -->
    </div>
  </div>
</template>
